/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
Traceback (most recent call last):
  File "/home/liuxuan/projects/Multi_HDA/main.py", line 142, in <module>
    main(args=args, params_dict=param,
  File "/home/liuxuan/projects/Multi_HDA/main.py", line 88, in main
    network, results = domain_training.training(encoder=ft_encoder,
  File "/home/liuxuan/projects/Multi_HDA/domain_training.py", line 96, in training
    transfer_loss, heuristic = myloss.HDA_UDA(hiddens, focals, len_s, len_t, ad_net, calc_coeff(epoch))
  File "/home/liuxuan/projects/Multi_HDA/myloss.py", line 42, in HDA_UDA
    return myloss(ad_out,dc_target), heuristic
  File "/home/liuxuan/anaconda3/envs/pytorch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1727, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/liuxuan/anaconda3/envs/pytorch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1738, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/liuxuan/projects/Multi_HDA/myloss.py", line 12, in forward
    entropy = - label * torch.log(input_ + self.epsilon) -(1 - label) * torch.log(1 - input_ + self.epsilon)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cuda:2!
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  242.1517
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  201.6256
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  194.2085
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  197.6333
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  212.5221
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  212.2673
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  215.2924
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  200.5294
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  202.1693
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  198.9797
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  198.9403
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  200.3189
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  211.6898
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  228.6732
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  242.7564
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  242.8037
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  212.4507
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  235.9673
-------------------- /home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  202.5244
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  224.1437
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  209.7088
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  239.1637
-------------------- /home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.895
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.0713
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  188.3747
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.022
-------------------- /home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.2357
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  197.6858
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  202.5144
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  205.9799
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- /home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  195.0005
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  197.4623
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  197.8881
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  197.4163
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  175.8649
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  197.8969
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  197.6571
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  195.2793
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  193.078
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  197.2435
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  197.0773
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  215.1827
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  210.7086
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  239.6013
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  199.793
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  197.8094
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  194.2907
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  197.3079
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  197.8465
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  197.9945
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  188.5124
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  196.8041
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  197.2703
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  197.6507
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  199.3331
AE training epoch 0
AE training epoch 50
tcga_labeled_df========================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  199.8843
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  199.416
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  200.2525
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  212.4328
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  199.6289
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  198.8734
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  197.9004
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  198.5525
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  198.9917
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  199.5906
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  197.9663
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  196.4914
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  198.9705
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  199.5455
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  199.1018
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  198.2773
-------------------- /home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  201.4576
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  209.0684
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  216.4644
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  205.9012
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: /home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  199.1478
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.4367
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  200.1877
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  199.8031
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  214.1788
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  207.1953
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  215.2514
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  215.2061
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  207.7921
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  212.9117
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  199.2434
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  199.0506
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  200.8822
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  207.2365
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  216.023
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  198.5012
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  215.6352
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  198.0441
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  204.8621
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  236.7857
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  198.8221
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  205.1203
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  214.9353
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  231.1384
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  242.21
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  200.134
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  241.8015
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  199.5259
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  219.5295
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  216.39
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  208.7999
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  173.9268
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  200.1227
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  216.3478
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  200.8606
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  239.7728
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  243.0528
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  200.2182
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  199.3726
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  203.791
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  220.0107
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  211.8509
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  165.0842
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  186.6036
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  197.4486
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  198.2806
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  196.9623
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  191.8518
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  197.8513
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  199.2566
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  199.92
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  197.3376
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  198.1527
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  200.497
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  215.0271
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  212.476
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  205.5938
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  211.1169
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  214.5964
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  237.0115
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  214.9781
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  215.5033
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  197.9795
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.2689
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  199.9031
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  196.3817
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.1317
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  192.4438
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  205.6367
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  197.9352
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  202.1503
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  192.9874
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  182.9905
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  188.802
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  200.5493
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  202.01
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  191.6431
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  184.3566
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  181.3074
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  181.2442
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  200.3621
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  192.8375
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  198.6624
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  198.7391
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  198.61
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  204.503
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
------domain adaption--------------
8-drug Elapsed time:  199.412
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  213.2656
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  208.1773
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  187.6449
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- /home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  200.3064
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  199.5396
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  198.3349
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  197.9785
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  209.4963
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  200.1055
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  199.9694
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  200.1011
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  198.9919
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  197.625
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  235.6944
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  214.6759
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  242.8239
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  242.5718
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  230.3819
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
AE training epoch 300
AE training epoch 350
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  241.051
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  213.2953
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  243.126
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  243.1142
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  228.525
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
AE training epoch 300
AE training epoch 350
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  207.4456
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  197.5554
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  198.3615
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  215.7047
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  199.9466
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
AE training epoch 300
AE training epoch 350
tcga_labeled_df========================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  197.9921
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  201.4491
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  201.1548
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
8-drug Elapsed time:  198.1908
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
------domain adaption--------------
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
8-drug Elapsed time:  198.2622
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
AE training epoch 300
AE training epoch 350
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  183.5796
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  241.3202
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  193.444
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.4038
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  199.0182
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
AE training epoch 300
AE training epoch 350
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  200.1692
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  199.2338
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: /home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.5595
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  199.3122
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.6231
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
AE training epoch 300
AE training epoch 350
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  199.176
-------------------- /home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.6285
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.9009
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.0406
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
------domain adaption--------------
8-drug Elapsed time:  198.4705
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
AE training epoch 300
AE training epoch 350
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  197.8545
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  197.6068
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  201.4996
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  211.1009
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  212.6336
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
AE training epoch 300
AE training epoch 350
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  204.6415
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  200.8024
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  198.4463
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  204.3946
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  197.7745
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
AE training epoch 300
AE training epoch 350
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  215.9209
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  179.5163
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  215.6081
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  212.7885
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
------domain adaption--------------
8-drug Elapsed time:  215.3367
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
AE training epoch 300
AE training epoch 350
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  208.3072
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  197.1057
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  198.1236
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  198.0922
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  197.5234
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
AE training epoch 300
AE training epoch 350
tcga_labeled_df========================================================
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  207.2077
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  197.86
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  215.3893
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
/home/liuxuan/projects/Multi_HDA/data.py:191: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][idx] == 1:
/home/liuxuan/projects/Multi_HDA/data.py:195: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  if ccle_labels.iloc[i][j] == 1:
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  208.4799
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  226.6463
AE training epoch 0
AE training epoch 50
AE training epoch 100
AE training epoch 150
AE training epoch 200
AE training epoch 250
AE training epoch 300
AE training epoch 350
tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        NaN        NaN
TCGA-18-3415        1.0         NaN  ...        NaN        NaN
TCGA-29-A5NZ        NaN         1.0  ...        NaN        NaN
TCGA-2G-AAF6        1.0         NaN  ...        NaN        1.0
TCGA-2G-AAF8        1.0         NaN  ...        NaN        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA58        1.0         NaN  ...        NaN        NaN
TCGA-ZF-AA5H        0.0         NaN  ...        NaN        NaN
TCGA-ZM-AA05        1.0         NaN  ...        NaN        1.0
TCGA-ZM-AA06        1.0         NaN  ...        NaN        1.0

[568 rows x 8 columns]
replaced_tcga_labeled_df========================================================
              Cisplatin  Paclitaxel  ...  Docetaxel  Etoposide
TCGA-13-A5FT        1.0         1.0  ...        0.0        0.0
TCGA-18-3415        1.0         0.0  ...        0.0        0.0
TCGA-29-A5NZ        0.0         1.0  ...        0.0        0.0
TCGA-2G-AAF6        1.0         0.0  ...        0.0        1.0
TCGA-2G-AAF8        1.0         0.0  ...        0.0        1.0
...                 ...         ...  ...        ...        ...
TCGA-ZF-AA53        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA58        1.0         0.0  ...        0.0        0.0
TCGA-ZF-AA5H       -1.0         0.0  ...        0.0        0.0
TCGA-ZM-AA05        1.0         0.0  ...        0.0        1.0
TCGA-ZM-AA06        1.0         0.0  ...        0.0        1.0

[568 rows x 8 columns]
tcga_labeled_gex_feature_df==============================================
                 PARVA     FMNL1      SORD  ...       LBH      MT1G       LYN
TCGA-13-A5FT -0.739746  0.166437 -0.546616  ... -0.732071  0.019915 -0.011012
TCGA-18-3415  0.505251 -0.930455  0.967023  ...  0.844738 -0.567679  1.088665
TCGA-29-A5NZ  0.761802  0.353674  0.319510  ...  1.026840  0.511013  0.527893
TCGA-2G-AAF6 -2.402115  0.709221 -0.408143  ...  1.313944  0.778215 -0.039788
TCGA-2G-AAF8 -2.070923  0.396190 -0.757098  ...  1.092503  1.393490 -0.303634
...                ...       ...       ...  ...       ...       ...       ...
TCGA-ZF-AA53 -0.140050  0.316769 -0.853720  ...  0.200803  0.434672  0.844303
TCGA-ZF-AA58  0.729927  1.783304 -1.299105  ...  0.293584  0.572052  0.753146
TCGA-ZF-AA5H -0.046504  1.203150 -0.530319  ...  0.508237 -0.040612  0.613372
TCGA-ZM-AA05 -2.641976  0.824592 -1.899810  ... -1.297006  0.814065 -0.064098
TCGA-ZM-AA06 -2.550445  0.096850 -1.820648  ... -0.359298  1.185442 -1.291784

[568 rows x 1426 columns]
Cell Line labels==============================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0        0.0
ACH-001498        0.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617        0.0         NaN  ...        1.0        NaN
ACH-000470        0.0         1.0  ...        0.0        0.0
...               ...         ...  ...        ...        ...
ACH-000603        0.0         NaN  ...        0.0        0.0
ACH-000916        0.0         0.0  ...        0.0        0.0
ACH-000978        0.0         0.0  ...        0.0        0.0
ACH-000561        0.0         1.0  ...        1.0        0.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Replaced ccle_labels=====================================================
DRUG_NAME   cisplatin  paclitaxel  ...  docetaxel  etoposide
ACH-000534        1.0         1.0  ...        1.0       -1.0
ACH-001498       -1.0         1.0  ...        1.0        1.0
ACH-000545        1.0         1.0  ...        1.0        1.0
ACH-001617       -1.0         0.0  ...        1.0        0.0
ACH-000470       -1.0         1.0  ...       -1.0       -1.0
...               ...         ...  ...        ...        ...
ACH-000603       -1.0         0.0  ...       -1.0       -1.0
ACH-000916       -1.0        -1.0  ...       -1.0       -1.0
ACH-000978       -1.0        -1.0  ...       -1.0       -1.0
ACH-000561       -1.0         1.0  ...        1.0       -1.0
ACH-000052        1.0         1.0  ...        1.0        1.0

[680 rows x 8 columns]
Sum of Cell Line labels=======================================================
DRUG_NAME
cisplatin           70.0
paclitaxel          38.0
cyclophosphamide    65.0
doxorubicin        -22.0
5-fluorouracil     -17.0
gemcitabine          9.0
docetaxel           13.0
etoposide           20.0
dtype: float64
[70.0, 38.0, 65.0, -22.0, -17.0, 9.0, 13.0, 20.0]
Label Graph===================================================================
[[ 70. 235. 221. 218. 242. 285. 251. 219.]
 [235.  38. 233. 199. 225. 223. 260. 194.]
 [221. 233.  65. 180. 190. 206. 225. 168.]
 [218. 199. 180. -22. 193. 230. 213. 247.]
 [242. 225. 190. 193. -17. 242. 233. 185.]
 [285. 223. 206. 230. 242.   9. 241. 227.]
 [251. 260. 225. 213. 233. 241.  13. 207.]
 [219. 194. 168. 247. 185. 227. 207.  20.]]
Normalizered Label Graph============================================================
[[0 1 1 1 1 1 1 1]
 [1 0 1 1 1 1 1 1]
 [1 1 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 1]
 [1 1 1 1 0 1 1 1]
 [1 1 1 1 1 0 1 1]
 [1 1 1 1 1 1 0 1]
 [1 1 1 1 1 1 1 0]]
Label Similarity============================================================
[[1.         0.00138313 0.00269542 0.00200938 0.         0.0019802
  0.00139567 0.00143472]
 [0.00138313 1.         0.16827853 0.59391965 0.09145527 0.42890443
  0.92436412 0.57468073]
 [0.00269542 0.16827853 1.         0.17424242 0.05871212 0.16709075
  0.17198697 0.17255163]
 [0.00200938 0.59391965 0.17424242 1.         0.09499024 0.43678161
  0.59901532 0.68753657]
 [0.         0.09145527 0.05871212 0.09499024 1.         0.11121409
  0.09446694 0.09022039]
 [0.0019802  0.42890443 0.16709075 0.43678161 0.11121409 1.
  0.42050087 0.41676505]
 [0.00139567 0.92436412 0.17198697 0.59901532 0.09446694 0.42050087
  1.         0.57445622]
 [0.00143472 0.57468073 0.17255163 0.68753657 0.09022039 0.41676505
  0.57445622 1.        ]]
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  243.5196
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  205.5517
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  199.0239
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  213.2192
-------------------- ['Cisplatin', 'Paclitaxel', 'Cyclophosphamide', 'Doxorubicin', '5-Fluorouracil', 'Gemcitabine', 'Docetaxel', 'Etoposide']
Cline training samples: torch.Size([544, 8])
Cline testing samples: torch.Size([136, 8])
TCGA testing samples: torch.Size([568, 8])
classification training epoch 0
classification training epoch 50
classification training epoch 100
classification training epoch 150
classification training epoch 200
classification training epoch 250
classification training epoch 300
classification training epoch 350
------domain adaption--------------
8-drug Elapsed time:  221.5
